<!DOCTYPE html>
<html>
  <head>
    <title>Google Maps Type-Ahead Search</title>
    <script src="https://maps.googleapis.com/maps/api/js?key=putYaOwnApiKeyBrothar&libraries=places"></script>
  </head>
  <body>
    <input id="search" type="text" placeholder="Enter a location">
    <div id="map" style="height: 500px;"></div>
    <div id="info"></div>

    <script>
      var map, places, infoWindow;
      var markers = [];
      var autocomplete;
      var countryRestrict = {country: 'us'};
      
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 39.3995, lng: -84.561335},
          zoom: 15
        });
        infoWindow = new google.maps.InfoWindow();
        places = new google.maps.places.PlacesService(map);
        
        autocomplete = new google.maps.places.Autocomplete(
          document.getElementById('search'), {
            types: ['geocode'],
            componentRestrictions: countryRestrict
          });
          
        autocomplete.addListener('place_changed', onPlaceChanged);
        

        // Add True West Coffee marker to the markers array
        var trueWestCoffee = new google.maps.Marker({
          position: { lat: 39.3957, lng: -84.5671 },
          title: "True West Coffee",
          map: map
        });
        markers.push(trueWestCoffee);

        // Add Starbucks marker to the markers array
        var starbucks = new google.maps.Marker({
          position: { lat: 39.4063, lng: -84.5713 },
          title: "Starbucks",
          map: map
        });
        markers.push(starbucks);
      }
      
function onPlaceChanged() {
  var place = autocomplete.getPlace();
  if (place.geometry) {
    map.panTo(place.geometry.location);
    map.setZoom(15);
    var lat = place.geometry.location.lat();
    var lng = place.geometry.location.lng();
    search(lat, lng); // Pass the latitude and longitude to the search function
  } else {
    document.getElementById('search').placeholder = 'Enter a location';
  }
}

      
function search(lat, lng) {
  var closestMarker = null;
  var closestDistance = Number.MAX_VALUE;
  for (var i = 0; i < markers.length; i++) {
    var marker = markers[i];
    var markerLat = marker.getPosition().lat();
    var markerLng = marker.getPosition().lng();
    var distance = getDistance(lat, lng, markerLat, markerLng);
    if (distance < closestDistance) {
      closestMarker = marker;
      closestDistance = distance;
    }
  }
  if (closestMarker) {
    var info = document.getElementById('info');
    info.innerHTML = 'Closest location: ' + closestMarker.getTitle();
  }
}

function getDistance(lat1, lng1, lat2, lng2) {
  var rad = Math.PI / 180;
  var dLat = (lat2 - lat1) * rad;
  var dLng = (lng2 - lng1) * rad;
  var a =
    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
    Math.cos(lat1 * rad) * Math.cos(lat2 * rad) *
    Math.sin(dLng / 2) * Math.sin(dLng / 2);
  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  var d = 6371 * c; // Earth's radius in km
  return d;
}


      
      function clearMarkers() {
        for (var i = 0; i < markers.length; i++) {
          markers[i].setMap(null);
        }
        markers = [];
      }
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=putYaOwnApiKeyBrothar&libraries=places&callback=initMap"></script>
  </body>
</html>
